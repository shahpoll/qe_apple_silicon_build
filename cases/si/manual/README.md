# Silicon (Si) Test Case — QE 7.4.1 on Mac mini M4

Artifacts produced during the Accelerate build validation:

- `data/Si.scf.in` — SCF input (8×8×8 mesh, `ecutwfc=30 Ry`, `ecutrho=240 Ry`).
- `logs/si_scf.txt` — SCF transcript (2 MPI ranks, Accelerate build).
- `logs/si_bands_pw.txt` — band-structure `pw.x` run (band path).
- `logs/si_bands_post.txt` — `bands.x` post-processing log.
- `logs/si_nscf_pw.txt` — dense 12×12×12 non-SCF run for DOS/PDOS (`nbnd=36`).
- `logs/si_dos.txt` — `dos.x` output for total density of states.
- `logs/si_projwfc.txt` — `projwfc.x` projection detail (Lowdin charges, PDOS).
- `data/silicon.bands.dat` / `.gnu` — eigenvalues along Γ–X–W–K–Γ–L.
- `data/silicon.dos` — total DOS sampled from -15 to 20 eV (energies shifted so E = 0 is E_F).
- `data/silicon.pdos_*` — projected DOS files per atom/orbital.
- `data/si_band_summary.txt` — computed Fermi level and band-gap metrics.
- `plots/si_band_structure.png` — rendered band plot (wrapper `scripts/plot_bands.py`).
- `plots/si_total_dos.png` — total DOS visualization (`scripts/plot_dos.py`).
- `plots/si_pdos.png` — projected DOS (s/p channels) via `scripts/plot_pdos.py`.

## Rebuilding plots

```sh
cd /path/to/qe_macm4_build/cases/si/manual
python3 scripts/plot_bands.py
python3 scripts/plot_dos.py
python3 scripts/plot_pdos.py
python3 scripts/analyze_bandgap.py
```

Shared helper logic lives in `../../common/scripts/` and accepts custom bases if you
need to point at a different dataset.

Temporary wavefunction and charge files live under `tmp/silicon.save` and can be
regenerated by rerunning the commands listed in `../../docs/Si_Worklog.md`.

## Key settings

- Pseudopotential: `cases/common/pp/Si.pbe-n-rrkjus_psl.1.0.0.UPF` (SSSP Efficiency 1.3.0 recommendation — 30/240 Ry, dual = 8).
- SCF k-mesh: 8×8×8 Monkhorst–Pack; NSCF/PDOS k-mesh: 12×12×12.
- `nbnd = 36` for NSCF and `projwfc.x`, ensuring conduction states up to ~47 eV are covered.
- PDOS energy window: `emin = -10 eV`, `emax = 15 eV`, `DeltaE = 0.05 eV` with Gaussian smearing.
- Plots generated via the wrapper scripts are aligned so that energy zero corresponds to the DOS-derived Fermi level.
- Convergence evidence lives under `../convergence/` (see README there for ΔE/Δgap scans).
- Parallel wrapper: use `../../../scripts/run_qe.sh <exe> -- -in data/...` to launch QE with 8 MPI ranks bound to individual cores. Override `QE_RANKS`, `QE_CPUSET`, or `OMP_NUM_THREADS` before calling the script to test different mixes of performance and efficiency cores (e.g. `QE_RANKS=10 QE_CPUSET=0-9`).
